# Создание фаз босса


Фазы босса - это подмеханика  Custom Bosses. Система, лежащая в основе этих фаз, настолько гибкая и мощная, что требует отдельного объяснения, чтобы убедиться, что вы используете эту функцию по максимуму.

### Как работают фазы босса?

Фазы босса можно добавить к любому  Custom Boss в EliteMobs, используя следующий формат конфигурации:

```yaml
phases:
- phase_2_boss.yml:0.X
- phase_3_boss.yml:0.Y
```

_**Примечание: босс, которого вы изначально порождаете, который содержит информацию обо всех других фазах, будет называться боссом фазы 1. Он не должен находиться в записи phases.**_

Основная цель этой механики - позволить администраторам изменять атрибуты  Custom Boss во время боя. Используя формат конфигурации выше, вы можете полностью менять файлы конфигурации от фазы к фазе, что означает, что вы можете изменить 99.99% атрибутов - например, способности, множители урона, множители здоровья, тип существа, маскировку, броню…

Чтобы добиться этого, EliteMobs удаляет вашего босса во время боя и мгновенно заменяет его версией из следующей фазы. Процесс происходит мгновенно, поэтому он, как правило, очень плавный, если только вы не хотите сделать его нарочито эффектным.

### Пример

Возьмем этот пример фазового босса:

Файл: phase_1_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: STRAY
powers:
- attack_gravity.yml
phases:
- phase_2_boss.yml:0.60
- phase_3_boss.yml:0.30
```

Файл: phase_2_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: SKELETON
powers:
- attack_gravity.yml
- arrow_fireworks.yml
```

Файл: phase_3_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: WITHER_SKELETON
powers:
- arrow_rain
```

Это является действительной конфигурацией фазового босса. Если вы создадите phase_1_boss.yml, то он появится как Stray с перечисленными выше атрибутами. После того как босс получит урон и его здоровье упадет до _60%_, он будет мгновенно заменен в том же месте  Custom Boss, созданным в phase_2_boss.yml, так как конфигурационный файл указывает `- phase_2_boss.yml:0.60` (_phase_2_boss.yml - это имя файла для этого  custom boss, 0.60 - это 60% здоровья_). _Обратите внимание, что босс фазы 2 появится с 60% здоровья, так как именно в этот момент он переходит в эту фазу._ У босса будут способности, указанные в файле phase_2_boss.yml. Как только босс фазы 2 получит урон и его здоровье упадет до 30%, он появится как босс, заданный для фазы 3. Обратите внимание, что способности фазы 3 не связаны с предыдущими - вы можете полностью изменять способности между фазами, как и практически все другие атрибуты.

## Дополнительно

### Наследуемые механики

Вот список элементов, которые не меняются от фазы к фазе:

- Первый босс фазы в цепочке определяет, через какие фазы босс будет проходить, то есть не стоит добавлять запись phases для других боссов в фазе.

- Таблица угрозы/таблица урона остаются прежними, то есть распределение добычи и продвинутая система аггро не затрагиваются изменением фазы.

- Переключение фаз основано на % потери здоровья, который сохраняется от фазы к фазе. Это означает, что если ваш босс настроен на переход в фазу 2 при 50% здоровья, босс, который появится, чтобы заменить босса фазы 1, все равно будет иметь 50% здоровья. Это также означает, что каждая фаза может иметь совершенно разное количество здоровья, без каких-либо проблем.

- Фазовые боссы возвращаются в фазу 1, если их здоровье восстанавливается до 100% по умолчанию, за счет регенерации боссов вне боя.

- Фазовые боссы, которые также являются региональными боссами, делят один и тот же радиус поводка и механику тайм-аута во всех фазах, и будут появляться снова как босс фазы 1 после завершения таймера появления.

#### Предупреждения

Вот список механик, которые работают таким образом, что может показаться нелогичным:

- Если фазовый босс убит во время любой фазы, он выронит лут этой фазы. Это означает, что если кому-то удастся убить фазового босса слишком быстро (с одного удара), он фактически умрет и выронит лут, который настроен для этого файла босса, а это не обязательно будет последняя фаза. Вы можете исправить это, установив таблицу лута одинаковой для всех файлов боссов для этого фазового босса, или убедившись, что ваши фазовые боссы имеют достаточно HP, чтобы их невозможно было убить с нескольких ударов. В качестве альтернативы, вы можете использовать специальные таблицы лута для людей, которые могут пропускать фазы.

- Поскольку фазовые боссы фактически заставляют  Custom Bosses появляться во время боя, они будут выполнять всю свою процедуру появления, когда появятся. Поэтому будьте осторожны с сообщениями о появлении и командами, которые выполняются при появлении. Кроме того, фазовые боссы не умирают, если они меняют фазы, их просто меняют на что-то другое. Это означает, что команды, которые выполняются при смерти, будут выполняться только для последнего фазового босса, или если игроку удастся пропустить фазу, нанеся достаточно урона. Команды, которые выполняются при появлении, могут быть использованы для связи с изменениями фаз. *Примечание:* сообщение о появлении не будет отправлено снова для босса фазы 1, если он появится снова из-за того, что фазовый босс был восстановлен до полного здоровья.

- Фазовые боссы могут быть оседланы или не оседланы между фазами. Если фазовый босс убит, прежде чем конь умрет, конь останется до следующей фазы. Если босс регенерирует до полного здоровья, конь удаляется, и босс становится без коня, если только он не настроен на то, чтобы сесть на существо во время фазы 1.

- Поскольку между фазами появляются новые  Custom Bosses, одноразовая механика появления сбрасывается между фазами и при полном восстановлении здоровья.

### Советы и хитрости

- Можно использовать тот факт, что экипировка и типы существ могут меняться во время боя, чтобы сделать босса более (или менее) опасным по мере его развития.

- Хотя это возможно, если у вас нет конкретной цели, лучше, чтобы способности фазового босса не менялись слишком сильно между фазами, так как игрокам, скорее всего, понравится более естественная прогрессия боя.

- Можно использовать команды onSpawn для запуска команд между фазами.

- Фазы можно использовать, чтобы переключить босса из режима ближнего боя в режим дальнего боя и наоборот.

- Фазовые боссы были созданы для того, чтобы быть сильными боссами с большим количеством HP. Обычно их лучше всего использовать как финальную встречу с боссом в подземельях или как крупных мировых боссов.

- При проектировании встреч имейте в виду, что подкрепления могут не быть убиты игроками между фазами.

- У боссов может быть любое количество фаз, но чем больше фаз у них будет, тем больше здоровья им понадобится, чтобы каждая фаза имела значение.

