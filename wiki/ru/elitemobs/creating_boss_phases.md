# Создание фаз босса

Фазы босса являются подмеханикой кастомных боссов. Система, лежащая в основе этих фаз, настолько гибкая и мощная, что
требует отдельного объяснения, чтобы убедиться, что вы хорошо используете эту функцию.

### Как работают фазы босса?

Фазы босса могут быть добавлены к любому кастомному боссу в EliteMobs, используя следующий формат конфигурации:

```yaml
phases:
- phase_2_boss.yml:0.X
- phase_3_boss.yml:0.Y
```

_**Примечание: босс, которого вы изначально вызываете и который содержит информацию обо всех остальных фазах, будет
называться боссом 1-й фазы. Его не должно быть в записи фаз.**_

Основная цель этого механизма - позволить администраторам изменять атрибуты кастомных боссов во время боя. Используя
формат конфигурации, указанный выше, вы можете полностью менять конфигурационные файлы от фазы к фазе, что означает, что
вы можете изменить 99,99% атрибутов - таких как способности, множители урона, множители здоровья, тип сущности,
маскировку, броню...

Чтобы это осуществить, EliteMobs удаляет вашего босса во время боя и мгновенно заменяет его версией из следующей фазы.
Процесс за этим происходит мгновенно, поэтому он, как правило, довольно плавный - если вы, конечно, не хотите сделать
его специально эффектным.

### Пример

Возьмем, к примеру, этого босса с фазами:

Файл: phase_1_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: STRAY
powers:
- attack_gravity.yml
phases:
- phase_2_boss.yml:0.60
- phase_3_boss.yml:0.30
```

Файл: phase_2_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: SKELETON
powers:
- attack_gravity.yml
- arrow_fireworks.yml
```

Файл: phase_3_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: WITHER_SKELETON
powers:
- arrow_rain
```

Это является валидным боссом с фазами. Если вы вызовете phase_1_boss.yml, появится бродяга с указанными выше атрибутами.
После того, как ему нанесут урон до _60%_ от его здоровья, он будет немедленно заменен в том же месте на кастомного
босса, сформированного в phase_2_boss.yml, поскольку в файле конфигурации указано `- phase_2_boss.yml:0.60` (
_phase_2_boss.yml - это имя файла для этого кастомного босса, 0,60 - это 60% здоровья_). _Обратите внимание, что босс
2-й фазы появится с 60% своего здоровья, так как именно при этом он переходит в эту фазу._ У босса будут способности,
указанные в файле phase_2_boss.yml. Как только боссу 2-й фазы нанесут урон до 30% его здоровья, появится босс,
установленный для 3-й фазы. Обратите внимание, что способности для 3-й фазы не связаны с предыдущими - вы можете
полностью менять способности между фазами, как и почти все другие атрибуты.

## Продвинутый уровень

### Унаследованные механики

Вот список того, что не меняется от фазы к фазе:

- Первый босс фазы в цепочке определяет, какие фазы пройдет босс, это означает, что вам не следует помещать запись фаз
  для других боссов в фазе.

- Таблица угроз / Таблица урона остаются неизменными, что означает, что на распределение добычи и продвинутую систему
  аггро не влияет смена фаз.

- Переключение фаз основано на % потерянного здоровья, который сохраняется от фазы к фазе. Это означает, что если ваш
  босс настроен на переход во 2-ю фазу при 50% здоровья, босс, который появится на замену боссу 1-й фазы, по-прежнему
  будет иметь 50% здоровья. Это также означает, что каждая фаза может иметь совершенно разное количество здоровья без
  каких-либо проблем.

- Боссы фаз возвращаются к 1-й фазе, если их здоровье восстановлено до полного через стандартную систему регенерации
  боссов вне боя

- Боссы фаз, которые также являются региональными боссами, имеют один и тот же радиус привязи и механику тайм-аута во
  всех фазах и будут возрождаться как босс 1-й фазы после окончания таймера возрождения.

#### Предупреждения

Вот список механик, которые работают так, что поначалу могут показаться нелогичными:

- Если босс фазы будет убит во время любой фазы, он выпадет добыча из этой фазы. Это означает, что если кому-то удастся
  убить босса фазы слишком быстро (ваншот), он фактически умрет и выпадет добыча, настроенная для этого файла босса,
  которая может не являться последней фазой. Вы можете исправить это, установив одинаковую таблицу добычи для всех
  файлов боссов для этого босса фазы, или убедившись, что у ваших боссов фаз достаточно HP до такой степени, что их
  невозможно убить всего за несколько ударов. В качестве альтернативы, вы можете иметь специальные таблицы добычи для
  людей, способных пропускать фазы.

- Поскольку боссы фаз фактически вызывают появление кастомных боссов во время боя, они будут выполнять всю свою
  процедуру появления при появлении. Поэтому будьте осторожны, когда дело доходит до сообщений о появлении и команд,
  выполняемых при появлении. Кроме того, боссы фаз не умирают при смене фаз, они просто меняются на что-то другое. Это
  означает, что команды, которые выполняются при смерти, будут выполняться только для последнего босса фазы, или если
  игроку удастся пропустить фазу, нанеся достаточно урона. Команды, которые выполняются при появлении, могут быть
  использованы для подключения к изменениям фазы. \*Примечание: \* сообщение о появлении не будет отправлено снова для
  босса 1-й фазы, если он возродится из-за того, что здоровье босса фазы было восстановлено до максимума.

- Боссы фаз могут появляться верхом или переставать быть верхом между фазами. Если босс фазы убит до того, как умер
  маунт, маунт сохранится и перейдет к следующей фазе. Если здоровье босса восстанавливается до максимума, маунт
  удаляется, и босс перестает быть верхом, если он не настроен на посадку на сущность во время 1-й фазы.

- Поскольку между фазами появляются новые кастомные боссы, механизм однократного появления сбрасывается между фазами и
  при полном исцелении.

### Советы и хитрости

- Вы можете использовать тот факт, что снаряжение и типы сущностей можно менять во время боя, чтобы босс выглядел все
  более (или менее) опасным на протяжении всего боя.

- Хотя это и возможно, если нет определенной цели, то, вероятно, лучше, чтобы способности, которые есть у босса фазы, не
  менялись слишком резко между фазами, поскольку игрокам, скорее всего, больше понравится прогрессия, которая кажется
  естественной на протяжении всего боя.

- Вы можете использовать команды onSpawn для выполнения команд между фазами

- Фазы можно использовать для переключения босса из режима ближнего боя в режим дальнего боя и наоборот

- Боссы фаз были созданы, чтобы быть сложными боссами с большим количеством HP. Обычно они лучше всего подходят в
  качестве финального босса для подземелий или в качестве больших мировых боссов.

- При разработке столкновений имейте в виду, что возможно, что подкрепления не будут убиты игроками между фазами.

- Боссы могут иметь любое количество фаз, которое вы хотите, но чем больше фаз у них будет, тем больше здоровья им
  потребуется, чтобы каждая фаза имела значение.
