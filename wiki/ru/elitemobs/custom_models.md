Начиная с EliteMobs 7.3.12, в EliteMobs были добавлены Пользовательские Модели через [Model Engine](https://mythiccraft.io/index.php?resources/model-engine%E2%80%94ultimate-entity-model-manager-1-16-5-1-20-4.389/) и [FreeMineCraftModels](https://www.spigotmc.org/resources/free-minecraft-models.111660/).

# Предисловие

С точки зрения EliteMobs, система Пользовательских Моделей очень проста, так как администраторам нужно лишь добавить строку в файл конфигурации NPC или Пользовательского Босса, указывающую, какую Пользовательскую Модель использовать. Однако, для полной функциональности этой системы необходимо выполнить правильные шаги с Model Engine и Minecraft, и это не так просто освоить.

Это руководство подробно расскажет о взаимодействии с Model Engine и Minecraft. Оно не научит вас использовать Blockbench для создания пользовательских боссов и не будет углубляться в детали работы Model Engine. Существует множество других руководств по этим темам, и если вы хотите узнать больше об этих системах, лучше обратиться непосредственно к их документации.

## FreeMineCraft Models

Если вы хотите узнать, как использовать FMM для работы с вашими моделями, вы можете ознакомиться с [этой](/ru/freeminecraftmodels/info.md) вики-страницей, чтобы узнать больше.

# Минимальные требования

EliteMobs 7.3.12 или новее, Model Engine R2.2.0\* или новее, Blockbench\*\*, использование ресурс-паков Minecraft.

\* Этот плагин может иметь дополнительные зависимости. Проверьте документацию на их стороне.
\*\* Необходим для создания и редактирования Пользовательских Моделей. Не нужен, если вы просто хотите установить контент без его изменения.

# Ручная настройка Пользовательской Модели

Примечание: Это руководство предполагает, что у вас уже есть действительная Пользовательская Модель. Они поставляются в формате файлов Blockbench (`.bbmodel`).

EliteMobs может использовать Пользовательские Модели для NPC и Пользовательских Боссов. Процесс для обоих одинаков и выглядит следующим образом:

## Шаг 1. Настройка конфигурации EliteMobs

Перейдите в файл конфигурации Пользовательского Босса или NPC, который вы хотите изменить, и добавьте следующую строку:

```yaml
customModel: modelname
```

Замените `modelname` на имя вашей модели. Имя — это имя файла Пользовательской Модели, который вы используете. Например, файл Пользовательской Модели Тестового Босса — `showcase_boss.bbmodel`. Таким образом, опция конфигурации должна быть:

```yaml
customModel: showcase_boss
```

И это все для EliteMobs! Теперь становится немного сложнее.

## Шаг 2. Генерация данных Model Engine

[_Примечание: В случае сомнений или проблем обратитесь к вики Model Engine здесь._](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#importing)

1.  Поместите файл Пользовательской Модели Blockbench (`.bbmodel`) в директорию `(вашСервер)/plugins/ModelEngine/blueprints` .
2.  Выполните команду `/meg reload` . Если все прошло правильно, вы должны получить сообщение `[Model Engine] X models loaded` , где `x` — это количество зарегистрированных вами моделей.

## Шаг 3. Генерация Ресурс-пака

[**Примечание: теперь есть альтернативный, более простой способ выполнить этот шаг по этой ссылке.**](/ru/elitemobs/custom_models.md&section=step-2.-generating-the-resource-pack) Однако, он немного менее гибкий, чем описанный здесь.

Это, возможно, самая сложная часть, если вы хотите, чтобы ваш сервер управлял загрузками. **Попробуйте проверить, работает ли система, когда ресурс-пак установлен на вашем клиенте, прежде чем заниматься его автоматическим распространением!**

1.  Перейдите в директорию `(вашСервер)/plugins/ModelEngine/resource pack` и создайте ресурс-пак, используя эти данные, или добавьте папку `assets` оттуда в папку `assets` вашего ресурс-пака.
    1.  Если вы создаете новый ресурс-пак, вы можете поместить файлы из `resource pack` в zip-архив, и это будет действительный ресурс-пак, который вы можете распространять. [Подробнее](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#preexisting-resource-pack).
    2.  Если у вас уже есть ресурс-пак, убедитесь, что вы случайно не перезаписываете существующие модели. [Подробнее](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#preexisting-resource-pack).
2.  Распространите ваш ресурс-пак среди игроков. **Только игроки, у которых установлен ресурс-пак, смогут видеть Пользовательские Модели**, а для всех остальных они будут выглядеть очень странно и сломанно. Если вы планируете активно использовать их, возможно, стоит принудить игроков использовать ресурс-пак.
    1.  (Необязательно) Чтобы игроки могли загружать ресурс-пак при входе, вам нужно будет разместить файл где-то онлайн и изменить поле `resource-pack=` в server.properties, чтобы оно указывало на этот адрес.**\***
    2.  (Необязательно) Если вы модифицируете ресурс-паки, вам стоит использовать опцию `resource-pack-sha1=`, чтобы сервер мог проверять, нужно ли обновить ресурс-пак игрока. Чтобы сгенерировать это значение, загрузите ваш ресурс-пак на [http://onlinemd5.com/](http://onlinemd5.com/) и убедитесь, что вы выбрали опцию SHA1. Вам придется делать это каждый раз, когда вы обновляете свой Ресурс-пак, иначе ваши пользователи не получат обновление.**\***
    3.  (Необязательно) Чтобы принудить игроков использовать ресурс-паки, используйте опцию `require-resource-pack=true` в server.properties.**\***

**Если вы изменили server.properties, вам потребуется перезагрузка!**

**\*** Примечание: Существует множество онлайн-руководств, которые могут помочь вам настроить это, если эти инструкции вам не помогают.

### Объединение ресурс-паков

Если вам нужно объединить ваши ресурс-паки, вы можете сделать это вручную. Но мы рекомендуем использовать онлайн-инструмент, такой как [merge.elmakers](https://merge.elmakers.com/), для объединения ваших ресурс-паков.

## Шаг 4. Надеемся, что работает

Предполагая, что все было сделано правильно, теперь вы должны видеть Пользовательскую Модель на вашем боссе или NPC. Вы можете призвать их с помощью команд:

*   Пользовательский Босс: `/em spawncustom filename.yml`
*   NPC: `/em spawnnpc filename.yml`

Затем вы можете удалить их с помощью команды `/em remove`.

# Создание и адаптация Пользовательских Моделей для EliteMobs

EliteMobs может использовать любую модель, считающуюся действительной Model Engine, что означает, что с ней можно сделать практически все.

Однако, когда дело доходит до анимаций, требуется использование определенных имен для анимаций, чтобы гарантировать, что боссы смогут их использовать.

Эти имена анимаций — те, что установлены в Blockbench на вкладке анимаций. Вы можете переименовать их в любое время, что означает, что вы можете адаптировать любые существующие модели для работы с EliteMobs.

## Анимации

Обратите внимание, что этот раздел все еще расширяется, так как эта система очень новая. Больше информации будет добавлено по мере поступления запросов на функции.

### idle

`idle` — это правильное имя анимации для сущностей, которые не находятся в бою и не двигаются. EliteMobs не изменяет стандартную систему анимации бездействия, используемую Model Engine.

### walk

`walk` — это правильное имя анимации для сущностей, которые двигаются. EliteMobs не изменяет стандартную систему анимации бездействия, используемую Model Engine.

### attack

Существует три типа анимаций атаки:

#### attack

`attack` — это правильное общее имя анимации для атаки босса.

#### attack_melee

`attack_melee` — это правильное имя анимации для атак, выполняемых Пользовательским Боссом с использованием стандартной ближней атаки Minecraft. Переопределяет `attack`. Обратите внимание, что анимация воспроизводится **после** нанесения урона. К сожалению, на данный момент это ограничение. Поэтому старайтесь делать анимацию очень быстрой.

#### attack_ranged

`attack_ranged` — это правильное имя анимации для атак, выполняемых Пользовательским Боссом при создании снаряда. Переопределяет `attack`. Обратите внимание, что анимация воспроизводится **после** выстрела снарядом. К сожалению, на данный момент это ограничение. Поэтому старайтесь делать анимацию очень быстрой.

### damaged

`damaged` — это правильное имя анимации для анимации получения урона, которую воспроизводит Пользовательский Босс при получении урона.

### death

`death` — это правильное имя анимации смерти. EliteMobs не изменяет стандартную систему анимации бездействия, используемую Model Engine.

### powers

Примечание: этот сегмент все еще находится в разработке. Ниже представлены запланированные функции.

Каждая способность в EliteMobs может иметь назначенную анимацию. Анимация всегда начинается при активации способности, и в настоящее время не предусмотрено никаких дополнительных триггеров на протяжении использования способности. Некоторые способности, такие как неуязвимость, не будут делать ничего, так как у них нет триггеров, и они являются просто пассивными свойствами боссов.

Чтобы назначить анимацию способности, анимация должна быть названа так же, как файл способности elitemobs.

Например, чтобы добавить анимацию к способности "зомби-некрономикон", анимация должна называться `zombie_necronomicon.yml`. Она начнет воспроизводиться сразу после активации способности и закончится, когда анимация завершится (если она не зациклена) или когда способность будет завершена.

# Импорт Пользовательских Моделей из подземелий

## Шаг 1. Обычный импорт

При импорте zip-архива упаковщика подземелий, содержащего Пользовательские Модели, Пользовательские Модели автоматически перемещаются в `(вашСервер)/plugins/ModelEngine/blueprints`, и Model Engine автоматически перезагружается для генерации соответствующих файлов ресурс-пака и Model Engine.

## Шаг 2. Генерация Ресурс-пака

Если вы находитесь онлайн при перезагрузке EliteMobs для импорта файлов, EliteMobs автоматически отправит сообщение в чат, по которому вы можете кликнуть, чтобы сгенерировать ресурс-пак EliteMobs. В качестве альтернативы вы можете выполнить команду `/em generateresourcepack`, чтобы сгенерировать его.

Выполнение этой команды копирует все файлы ресурс-пака в папку `exports` EliteMobs неразрушающим способом. Это означает, что если вы распакуете ресурс-пак в папку exports, используя имя ресурс-пака `elitemobs_resource_pack` для папки вашего ресурс-пака, EliteMobs не удалит ни один из файлов там, если только файл с таким же именем не будет получен от ModelEngine (за исключением pack.meta и pack.png). Таким образом, вы можете обновлять свой ресурс-пак, не теряя модели, которые вы ранее в него поместили.

Наконец, EliteMobs архивирует ресурс-пак в папке `exports`, и этот файл готов к распространению.

После этого EliteMobs также предлагает обновить код SHA1 для вашего ресурс-пака.

### Шаг 2.5. Обновление SHA1

Код SHA1 в файле `server.properties` используется для информирования клиентов о том, устарел ли их ресурс-пак, и при необходимости заставляет их обновить его. Этот код может быть сгенерирован через EliteMobs, нажав на опцию в чате, которая появляется после шага 2, или выполнив команду `/em updateresourcepack`.

**Имейте в виду, что это обновляет ваш файл server.properties правильным кодом SHA1 для заархивированного ресурс-пака в папке `exports`.** Если вы удалите или измените заархивированный файл после выполнения команды, это не сработает.

## Шаг 3. Сделайте файл общедоступным

Разместите файл в выбранном вами месте. Некоторые используют для этого Google Drive или Dropbox. Лучше разместить этот файл самостоятельно, если у вас есть такая возможность. Некоторые плагины также могут помочь вам разместить его непосредственно с вашего сервера Minecraft. Если вы найдете такой работающий плагин, сообщите об этом MagmaGuy в Discord, и этот пост будет обновлен этой информацией.