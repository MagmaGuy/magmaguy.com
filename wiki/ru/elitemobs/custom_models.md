[![webapp_banner.jpg](../../../img/wiki/webapp_banner.jpg)](https://magmaguy.com/webapp/webapp.html)

# Кастомные модели в EliteMobs

Начиная с EliteMobs 7.3.12,  Custom Models  были добавлены в EliteMobs через [Model Engine](https://mythiccraft.io/index.php?resources/model-engine%E2%80%94ultimate-entity-model-manager-1-16-5-1-20-4.389/) и [FreeMineCraftModels](https://www.spigotmc.org/resources/free-minecraft-models.111660/).

# Введение

С точки зрения EliteMobs, система  Custom Model  очень проста, так как единственное, что нужно сделать администраторам, - это добавить строку в файл конфигурации NPC или  Custom Boss, чтобы указать, какую  Custom Model  использовать. Однако, чтобы эта система работала в полной мере, необходимо выполнить определенные действия с Model Engine и Minecraft, а это уже не так просто.

В этом гайде подробно описаны  действия по взаимодействию с Model Engine и Minecraft.  В нем не рассказывается, как использовать Blockbench для создания  Custom Bosses, и не дается подробной информации о работе Model Engine. Существуют  множество других гайдов  о том, как это сделать, и, если вы хотите узнать больше о этих системах, лучше обратиться непосредственно к их документации.

## FreeMineCraft Models

Если вы хотите узнать, как использовать FMM, чтобы ваши модели работали, вы можете посмотреть [эту]($language$/freeminecraftmodels/info.md) страницу вики, чтобы получить дополнительную информацию.

# Минимальные требования

EliteMobs 7.3.12 или выше, Model Engine R2.2.0\* или выше, Blockbench\*\*, использование пакетов ресурсов Minecraft.

\* Этот плагин может иметь дополнительные зависимости. Проверьте документацию с их стороны.  
\*\*  Необходимо для создания и редактирования  Custom Models.  Не требуется, если вы просто хотите установить контент без изменений.

# Ручная настройка  Custom Model

Примечание: В этом гайде предполагается, что у вас уже есть допустимый  Custom Model.  Они поставляются в форматах файлов Blockbench (`.bbmodel`).

EliteMobs может использовать  Custom Models  для NPCs и  Custom Bosses.  Процесс одинаков для обоих типов и выглядит следующим образом:

## Шаг 1. Настройка конфигурации EliteMobs

Перейдите в конфигурационный файл  Custom Boss  или NPC, который вы хотите изменить, и добавьте следующую строку:

```yaml
customModel: modelname
```

Замените `modelname` на имя вашего модели. Имя - это имя файла  Custom Model, который вы используете. Например, файл  Custom Model  Test Boss - это `showcase_boss.bbmodel`. Таким образом, в конфигурации должна быть следующая строка:

```yaml
customModel: showcase_boss
```

И это все для EliteMobs! Теперь немного сложнее.

## Шаг 2. Генерация данных Model Engine

[_Примечание:  В случае сомнений или проблем обратитесь к вики Model Engine здесь._](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#importing)

1.  Поместите файл вашего  Custom Model  Blockbench (`.bbmodel`) в папку `(yourServer)/plugins/ModelEngine/blueprints`.
2.  Выполните команду `/meg reload`.  Если все прошло успешно, вы должны увидеть сообщение `[Model Engine] X models loaded`, где `x` - количество зарегистрированных моделей.

## Шаг 3. Генерация пакета ресурсов

[**Примечание: сейчас есть альтернативный, более простой способ выполнить этот шаг, описанный по этой ссылке.**]($language$/elitemobs/custom_models.md&section=step-2.-generating-the-resource-pack)  Однако, этот способ менее гибок, чем описанный здесь.

Этот шаг, возможно, самый сложный, если вы хотите, чтобы ваш сервер управлял загрузками. **Попробуйте проверить, работает ли система, когда у вас есть пакет ресурсов на вашем клиенте, прежде чем пытаться распространять его автоматически!**

1.  Перейдите в папку `(yourServer)/plugins/ModelEngine/resource pack` и создайте пакет ресурсов с помощью этих данных или добавьте папку `assets` туда в `assets`  вашего пакета ресурсов.
    1.  Если вы создаете новый пакет ресурсов, вы можете поместить файлы в `resource pack` в заархивированный файл, и это будет действительный пакет ресурсов, который вы можете распространять.  [Подробнее](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#preexisting-resource-pack).
    2.  Если у вас уже есть пакет ресурсов, убедитесь, что вы случайно не перезаписываете существующие модели.  [Подробнее](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#preexisting-resource-pack).
2.  Распространите свой пакет ресурсов среди игроков.  **Только игроки, у которых есть пакет ресурсов, смогут видеть  Custom Models**, и он будет выглядеть очень странно и сломано для всех остальных. Если вы планируете активно использовать их, вы можете  заставить игроков использовать пакет ресурсов.
    1.  (Дополнительно)  Чтобы позволить игрокам загрузить пакет ресурсов при входе, вам нужно разместить файл в Интернете и изменить поле `resource-pack=`  в файле server.properties, чтобы оно указывало на этот адрес.**\***
    2.  (Дополнительно) Если вы изменяете пакеты ресурсов, вам нужно использовать опцию `resource-pack-sha1=`, чтобы сервер мог проверить, нужно ли обновлять пакет ресурсов игрока. Чтобы сгенерировать это значение, загрузите свой пакет ресурсов на [http://onlinemd5.com/](http://onlinemd5.com/) и убедитесь, что вы выбрали опцию SHA1. Вам нужно будет делать это каждый раз, когда вы обновляете свой пакет ресурсов, иначе ваши пользователи не получат обновление.**\***
    3.  (Дополнительно) Чтобы заставить игроков использовать пакеты ресурсов, используйте опцию `require-resource-pack=true` в файле server.properties.**\***

**Если вы изменили server.properties, вам нужно перезагрузить сервер!**

**\*** Примечание: Существует множество гайдов в Интернете, которые могут помочь вам настроить это, если эти инструкции не работают.

### Слияние пакетов ресурсов

Если вам нужно объединить пакеты ресурсов, вы можете сделать это вручную. Но мы рекомендуем использовать онлайн-инструмент, такой как [merge.elmakers](https://merge.elmakers.com/), для объединения пакетов ресурсов.

## Шаг 4. Надеемся, что все работает

Предполагая, что все было сделано правильно, вы теперь должны увидеть  Custom Model  на вашем боссе или NPC. Вы можете создать их с помощью команд:

*   Custom Boss: `/em spawncustom filename.yml`
*   NPC: `/em spawnnpc filename.yml`

Затем вы можете удалить их с помощью команды `/em remove`.

# Создание и адаптация  Custom Models  для EliteMobs

EliteMobs может использовать любую модель, считающуюся допустимой Model Engine, то есть практически все можно сделать.

Однако, когда дело доходит до анимации, необходимо использовать определенные имена для анимаций, чтобы гарантировать, что боссы могут использовать эти анимации.

Эти имена анимаций задаются в Blockbench на вкладке анимаций. Вы можете переименовать их в любое время, то есть можете модернизировать любые существующие модели, чтобы они работали с EliteMobs.

## Анимации

Обратите внимание, что этот раздел все еще находится в разработке, так как эта система очень новая. В него будут добавляться новые элементы по мере поступления запросов на функционал.

### idle

`idle` - это правильное имя анимации для сущностей, которые не находятся в бою и не движутся. EliteMobs не изменяет систему анимации idle по умолчанию, используемую Model Engine.

### walk

`walk` - это правильное имя анимации для сущностей, которые движутся. EliteMobs не изменяет систему анимации idle по умолчанию, используемую Model Engine.

### attack

Существует три типа анимаций атаки:

#### attack

`attack` - это правильное универсальное имя анимации для того, когда босс атакует.

#### attack_melee

`attack_melee` - это правильное имя анимации для атак, которые  Custom Boss  выполняет, атакуя сущность с помощью стандартной атаки ближнего боя Minecraft.  Переопределяет  `attack`.  Обратите внимание, что анимация воспроизводится **после** нанесения урона. К сожалению, это ограничение на данный момент. Поэтому старайтесь сделать анимацию очень быстрой.

#### attack_ranged

`attack_ranged` - это правильное имя анимации для атак, которые  Custom Boss  выполняет, генерируя сущность-снаряд.  Переопределяет  `attack`.  Обратите внимание, что анимация воспроизводится **после** того, как снаряд выпущен. К сожалению, это ограничение на данный момент. Поэтому старайтесь сделать анимацию очень быстрой.

### damaged

`damaged` - это правильное имя анимации для анимации получения урона, которую  Custom Boss  воспроизводит при получении урона.

### death

`death` - это правильное имя анимации для анимации смерти. EliteMobs не изменяет систему анимации idle по умолчанию, используемую Model Engine.

### powers

Примечание: этот раздел все еще находится в разработке. Ниже описаны функции, которые запланированы.

Каждая способность в EliteMobs может иметь назначенную ей анимацию. Анимация всегда запускается при активации способности, и в данный момент не предусмотрено никаких дополнительных триггеров в течение использования способности. Некоторые способности, например, неуязвимость, не будут делать ничего, так как у них нет триггеров, и они просто пассивные свойства боссов.

Чтобы назначить анимацию способности, ее имя должно совпадать с именем файла способности elitemobs.

Например, чтобы добавить анимацию к способности necronomicon зомби, анимация должна называться `zombie_necronomicon.yml`. Она начнет воспроизводиться, как только способность будет активирована, и закончится, когда анимация закончится, если она не настроена на цикл, или когда способность завершена.

# Импорт  Custom Models  из подземелий

## Шаг 1. Обычный импорт

При импорте заархивированной папки  dungeon packager, которая содержит  Custom Models,  Custom Models  автоматически перемещаются в `(yourServer)/plugins/ModelEngine/blueprints`, а Model Engine автоматически перезагружается для генерации соответствующего пакета ресурсов и файлов Model Engine.

## Шаг 2. Генерация пакета ресурсов

Если вы находитесь в сети, когда перезагружаете EliteMobs для импорта файлов, EliteMobs автоматически опубликует в чате сообщение, на которое можно нажать, чтобы сгенерировать пакет ресурсов EliteMobs. В качестве альтернативы, вы можете запустить команду `/em generateresourcepack`, чтобы сгенерировать его.

Выполнение этой команды копирует все файлы пакета ресурсов в папку `exports`  EliteMobs  без разрушения. Это означает, что если вы распакуете пакет ресурсов в папку exports, используя имя пакета ресурсов `elitemobs_resource_pack` для вашей папки пакета ресурсов, EliteMobs не удалит никакие файлы в ней, если только файл с таким же именем не будет получен от Model Engine (кроме pack.meta и pack.png). Таким образом, вы можете обновлять свой пакет ресурсов, не теряя модели, которые вы в него поместили ранее.

Наконец, EliteMobs архивирует пакет ресурсов в папке `exports`, и этот файл готов к распространению.

После этого EliteMobs также предлагает обновить код SHA1 для вашего пакета ресурсов.

### Шаг 2.5. Обновление SHA1

Код SHA1 в файле `server.properties` используется, чтобы клиенты знали, устарел ли их пакет ресурсов, и заставляет их обновить его, если это необходимо. Этот код можно сгенерировать с помощью EliteMobs, нажав на опцию в чате, которая появляется после шага 2, или запустив команду `/em updateresourcepack`

**Помните, что это обновляет ваш файл server.properties правильным кодом SHA1 для заархивированного пакета ресурсов в папке `exports`.** Если вы удалите его или измените заархивированный файл после выполнения команды, он не будет работать.

## Шаг 3. Сделайте файл общедоступным

Разместите файл в выбранном вами месте. Некоторые люди используют Google Drive или Dropbox для этого. Лучше разместить файл самостоятельно, если у вас есть такая возможность. Некоторые plugins могут также помочь вам разместить его прямо на вашем сервере Minecraft. Если вы найдете такой plugin, который работает, дайте знать MagmaGuy в Discord, и эта запись будет обновлена этой информацией.



