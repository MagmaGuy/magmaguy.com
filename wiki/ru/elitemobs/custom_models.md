Начиная с версии EliteMobs 7.3.12, в EliteMobs добавлены пользовательские модели через [Model Engine](https://mythiccraft.io/index.php?resources/model-engine%E2%80%94ultimate-entity-model-manager-1-16-5-1-20-4.389/) и [FreeMineCraftModels](https://www.spigotmc.org/resources/free-minecraft-models.111660/).

# Предисловие

С точки зрения EliteMobs, система пользовательских моделей очень проста, поскольку единственное, что нужно сделать
администраторам, это добавить строку в конфигурационный файл NPC или Пользовательского босса, указывающую, какую
пользовательскую модель использовать. Однако необходимо предпринять правильные шаги с Model Engine и Minecraft, чтобы
эта система работала полноценно, и с этим не так просто разобраться.

В этом руководстве подробно рассказывается о взаимодействии с Model Engine и Minecraft. В нем не рассказывается, как
использовать Blockbench для создания пользовательских боссов, и не рассказывается подробно о том, как работает Model
Engine. Уже существует множество руководств о том, как это сделать, и если вы хотите узнать больше об этих системах, вам
лучше обратиться непосредственно к их документации.

## FreeMineCraft Models

Если вы хотите узнать, как использовать FMM для работы ваших моделей, вы можете ознакомиться
с [этой]($language$/freeminecraftmodels/info.md) вики-страницей, чтобы узнать больше.

# Минимальные требования

EliteMobs 7.3.12 или более поздняя версия, Model Engine R2.2.0\* или более поздняя версия, Blockbench\*\*, использование
пакетов ресурсов Minecraft.

\* Этот плагин может иметь дополнительные зависимости. Проверьте документацию на их стороне.
\*\* Необходимо для создания и редактирования пользовательских моделей. Не требуется, если вы просто хотите установить контент, не изменяя его.

# Ручная настройка пользовательской модели

Примечание: это руководство предполагает, что у вас уже есть действующая пользовательская модель. Они поставляются в
форматах файлов Blockbench (`.bbmodel`).

EliteMobs может использовать пользовательские модели для NPC и пользовательских боссов. Процесс для этого одинаков для
обоих и выглядит следующим образом:

## Шаг 1. Настройка конфигурации EliteMobs

Перейдите к файлу конфигурации пользовательского босса или NPC, которого вы хотите изменить, и добавьте следующую строку:

```yaml
customModel: modelname
```

Замените `modelname` именем вашей модели. Имя — это имя файла пользовательской модели, которую вы используете. Например,
файл пользовательской модели тестового босса — `showcase_boss.bbmodel`. Таким образом, параметр конфигурации должен быть
следующим:

```yaml
customModel: showcase_boss
```

И это все для EliteMobs! Теперь все становится немного сложнее.

## Шаг 2. Генерация данных Model Engine

[_Примечание: в случае сомнений или проблем обратитесь к вики Model Engine здесь._](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#importing)

1. Поместите файл пользовательской модели Blockbench (`.bbmodel`) в
   каталог `(вашСервер)/plugins/ModelEngine/blueprints` .
2. Выполните команду `/meg reload` . Если все сработало правильно, вы должны получить
   сообщение `[Model Engine] X models loaded` , где `x` — это количество зарегистрированных у вас моделей.

## Шаг 3. Генерация пакета ресурсов

[**Примечание: теперь есть альтернативный, более простой способ выполнить этот шаг по этой ссылке.
**]($language$/elitemobs/custom_models.md&section=step-2.-generating-the-resource-pack) Однако он немного менее гибкий,
чем то, что указано здесь.

Это, возможно, самая сложная часть, если вы хотите, чтобы ваш сервер управлял загрузками. **Сначала проверьте, работает
ли система, когда у вас есть пакет ресурсов на вашем клиенте, прежде чем рассматривать возможность автоматического его
распространения!**

1. Перейдите в каталог `(вашСервер)/plugins/ModelEngine/resource pack` и создайте пакет ресурсов, используя эти данные,
   или добавьте папку `assets` в папку `assets` вашего пакета ресурсов.
    1. Если вы создаете новый пакет ресурсов, вы можете поместить файлы в папку `resource pack` в заархивированный файл,
       и это будет действительный пакет ресурсов, который вы можете
       распространять. [Подробнее](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#preexisting-resource-pack).
    2. Если у вас уже есть пакет ресурсов, убедитесь, что вы случайно не перезаписываете существующие
       модели. [Подробнее](https://github.com/Ticxo/Model-Engine-Wiki/wiki/Importing-and-Exporting#preexisting-resource-pack).
2. Распространите свой пакет ресурсов среди своих игроков. **Только игроки, у которых есть пакет ресурсов, смогут видеть
   пользовательские модели**, а для всех остальных это будет выглядеть очень странно и поломанно. Если вы намерены
   активно их использовать, вам может потребоваться принудительное использование пакета ресурсов.
    1. (Необязательно) Чтобы разрешить игрокам загружать пакет ресурсов при входе в систему, вам нужно разместить файл
       где-нибудь в Интернете и изменить поле `resource-pack=` в server.properties, чтобы оно указывало на этот
       адрес.**\***
    2. (Необязательно) Если вы изменяете пакеты ресурсов, вы захотите использовать параметр `resource-pack-sha1=`, чтобы
       сервер мог проверить, нужно ли обновлять пакет ресурсов игрока. Чтобы сгенерировать это значение, загрузите свой
       пакет ресурсов на [http://onlinemd5.com/](http://onlinemd5.com/) и убедитесь, что вы выбрали параметр SHA1. Вам
       придется делать это каждый раз, когда вы обновляете свой пакет ресурсов, иначе ваши пользователи не получат
       обновления.**\***
    3. (Необязательно) Чтобы принудительно заставить игроков использовать пакеты ресурсов, используйте
       параметр `require-resource-pack=true` в server.properties.**\***

**Если вы изменили server.properties, вам нужно будет перезапустить!**

**\*** Примечание: в Интернете есть много руководств, которые могут помочь вам в этом, если эти инструкции вам не
помогают.

### Объединить пакеты ресурсов

Если вам нужно объединить свои пакеты ресурсов, вы можете сделать это вручную. Но мы рекомендуем использовать
онлайн-инструмент, такой как [merge.elmakers](https://merge.elmakers.com/), для объединения ваших пакетов ресурсов.

## Шаг 4. Надежда, что это сработает

Если все было сделано правильно, вы теперь должны увидеть пользовательскую модель на своем боссе или NPC. Вы можете
вызвать их с помощью команд:

* Пользовательский босс: `/em spawncustom filename.yml`
* NPC: `/em spawnnpc filename.yml`

Затем вы можете удалить их с помощью команды `/em remove`.

# Создание и адаптация пользовательских моделей для EliteMobs

EliteMobs может использовать любую модель, считающуюся допустимой Model Engine, а это означает, что с ней можно многое
сделать.

Однако, когда дело доходит до анимации, для гарантии того, что боссы могут использовать анимацию, требуется
использование определенных имен для анимации.

Эти имена анимации — это те, которые установлены в Blockbench на вкладке анимации. Вы можете переименовать их в любое
время, что означает, что вы можете переоборудовать любые существующие модели для работы с EliteMobs.

## Анимации

Обратите внимание, что этот раздел все еще расширяется, так как эта система еще очень новая. По мере поступления
запросов на функции будет добавляться больше.

### idle

`idle` — это правильное имя анимации для сущностей, которые не находятся в бою и не двигаются. EliteMobs не изменяет
систему анимации простоя по умолчанию, используемую Model Engine.

### walk

`walk` — это правильное имя анимации для движущихся сущностей. EliteMobs не изменяет систему анимации простоя по
умолчанию, используемую Model Engine.

### attack

Существует три типа анимации атаки:

#### attack

`attack` — это правильное общее имя анимации для момента, когда босс атакует.

#### attack_melee

`attack_melee` — это правильное имя анимации для атак, выполняемых, когда пользовательский босс атакует сущность,
используя ванильную атаку ближнего боя Minecraft. Переопределяет `attack` . Обратите внимание, что анимация
воспроизводится **после** нанесения урона. К сожалению, на данный момент это ограничение. Поэтому постарайтесь сделать
анимацию очень быстрой.

#### attack_ranged

`attack_ranged` — это правильное имя анимации для атак, выполняемых, когда пользовательский босс порождает снаряд.
Переопределяет `attack`. Обратите внимание, что анимация воспроизводится **после** выстрела снаряда. К сожалению, на
данный момент это ограничение. Поэтому постарайтесь сделать анимацию очень быстрой.

### damaged

`damaged` — это правильное имя анимации для анимации боли, которую пользовательский босс воспроизводит при повреждении.

### death

`death` — это правильное имя анимации для анимации смерти. EliteMobs не изменяет систему анимации простоя по умолчанию,
используемую Model Engine.

### powers

Примечание: этот раздел все еще находится в разработке. Ниже приведены функции в том виде, в каком они запланированы.

Каждая сила в EliteMobs может иметь назначенную анимацию. Анимация всегда начинается, когда срабатывает сила, и в
настоящее время никакие дополнительные триггеры не предоставляются на протяжении всего использования силы. Некоторые
силы, такие как неуязвимость, ничего не будут делать, поскольку у них нет триггеров и они являются просто пассивными
свойствами боссов.

Чтобы назначить анимацию силе, анимация должна иметь то же имя, что и файл силы elitemobs.

Например, чтобы добавить анимацию к силе зомби некрономикон, анимация должна называться `zombie_necronomicon.yml` . Она
начнет воспроизводиться, как только сработает сила, и закончится, когда анимация закончится, если она не настроена на
цикл, или когда сила закончится.

# Импорт пользовательских моделей из подземелий

## Шаг 1. Обычный импорт

При импорте заархивированной папки упаковщика подземелий, содержащей пользовательские модели, пользовательские модели
автоматически перемещаются в `(вашСервер)/plugins/ModelEngine/blueprints`, а Model Engine автоматически перезагружается
для создания соответствующих пакетов ресурсов и файлов Model Engine.

## Шаг 2. Генерация пакета ресурсов

Если вы находитесь в сети, когда перезагружаете EliteMobs для импорта файлов, EliteMobs автоматически опубликует
сообщение в чате, на которое можно нажать, чтобы сгенерировать пакет ресурсов EliteMobs. В качестве альтернативы вы
можете выполнить команду `/em generateresourcepack`, чтобы сгенерировать его.

Выполнение этой команды копирует все файлы пакета ресурсов в папку `exports` EliteMobs неразрушающим способом. Это
означает, что если вы разархивируете пакет ресурсов в папку экспорта, используя имя пакета
ресурсов `elitemobs_resource_pack` для папки своего пакета ресурсов, EliteMobs не удалит ни один из файлов, если только
файл с тем же именем не будет получен от ModelEngine (за исключением pack.meta и pack.png). Таким образом, вы можете
обновлять свой пакет ресурсов, не теряя модели, которые вы ранее поместили в него.

Наконец, EliteMobs архивирует пакет ресурсов в папке `exports`, и этот файл готов к распространению.

После этого EliteMobs также предлагает обновить код SHA1 для вашего пакета ресурсов.

### Шаг 2.5. Обновление SHA1

Код SHA1 в файле `server.properties` используется для того, чтобы клиенты знали, устарел ли их пакет ресурсов, и
заставлял их обновлять его, если это необходимо. Этот код можно сгенерировать через EliteMobs, нажав на опцию в чате,
которая появляется после шага 2, или выполнив команду `/em updateresourcepack`

**Имейте в виду, что это обновляет ваш файл server.properties правильным кодом SHA1 для заархивированного пакета
ресурсов в папке `exports`.** Если вы удалите его или измените заархивированный файл после выполнения команды, это не
сработает.

## Шаг 3. Сделайте файл общедоступным

Разместите файл в выбранном вами месте. Некоторые люди используют для этого Google Drive или Dropbox. Лучше разместить
этот файл самостоятельно, если у вас есть такая возможность. Некоторые плагины также могут помочь вам разместить его
непосредственно с вашего сервера Minecraft. Если вы найдете такой плагин, который работает, дайте знать MagmaGuy в
Discord, и этот пост будет обновлен этой информацией.
