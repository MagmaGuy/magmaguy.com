# ボスフェーズの作成


ボスフェーズは、カスタムボスのサブメカニズムです。これらのフェーズの背後にあるシステムは非常に柔軟で強力なため、この機能を最大限に活用できるように、独自の専用の解説が必要です。

### ボスフェーズの仕組み

ボスフェーズは、次の構成形式を使用して、EliteMobs のカスタムボスにすべて追加できます。

```yaml
phases:
- phase_2_boss.yml:0.X
- phase_3_boss.yml:0.Y
```

_**注意: 他のすべてのフェーズの情報を含む、最初にスポーンするボスは、フェーズ 1 のボスと呼ばれます。このボスは、phases エントリには含まれていません。**_

このメカニズムの背後にある基本的な意図は、管理者が戦闘中にカスタムボスの属性を変更できるようにすることです。上記の構成形式を使用することで、フェーズごとに構成ファイルを完全に変更できます。つまり、パワー、ダメージ乗数、体力乗数、エンティティタイプ、変装、着用しているアーマーなど、属性の 99.99% を変更できます。

これを達成するために、EliteMobs は戦闘中にボスを削除し、次のフェーズのバージョンですぐに置き換えます。このプロセスは瞬時に行われるため、非常にシームレスに見えます。ただし、意図的に派手にすることもできます。

### 例

この例では、フェーズボスを使用します。

ファイル: phase_1_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: STRAY
powers:
- attack_gravity.yml
phases:
- phase_2_boss.yml:0.60
- phase_3_boss.yml:0.30
```

ファイル: phase_2_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: SKELETON
powers:
- attack_gravity.yml
- arrow_fireworks.yml
```

ファイル: phase_3_boss.yml

```yaml
isEnabled: true
level: 50
healthMultiplier: 10
entityType: WITHER_SKELETON
powers:
- arrow_rain
```

これは、有効なフェーズボスを構成しています。phase_1_boss.yml をスポーンすると、上記にリストされている属性を持つ Stray がスポーンされます。体力の _60%_ までダメージを受けると、構成ファイルに `- phase_2_boss.yml:0.60` と記載されているため (_phase_2_boss.yml はそのカスタムボスのファイル名で、0.60 は体力の 60% です_)、カスタムボスが phase_2_boss.yml で構成されているように、同じ場所にすぐに置き換えられます。_フェーズ 2 のボスは、フェーズが切り替わるタイミングであるため、体力の 60% でスポーンすることに注意してください。_ ボスは phase_2_boss.yml ファイルにリストされているパワーを持ちます。フェーズ 2 のボスが体力の 30% までダメージを受けると、フェーズ 3 に設定されているボスがスポーンされます。フェーズ 3 のパワーは、以前のパワーとは無関係であることに注意してください。ほぼすべての他の属性と同様に、フェーズ間でパワーを完全に変更できます。

## 高度な機能

### 継承されたメカニズム

フェーズ間で変わらないもののリストを以下に示します。

- チェーン内の最初のフェーズボスが、ボスが通過するフェーズを決定します。つまり、他のボスのフェーズエントリには何も置くべきではありません。

- スレッドテーブル/ダメージテーブルはそのまま維持されるため、戦利品分配と高度な aggro システムはフェーズの変更の影響を受けません

- フェーズの切り替えは、体力の減少率に基づいています。これは、フェーズ間で保持されます。つまり、ボスが体力の 50% でフェーズ 2 に入るように設定されている場合、フェーズ 1 のボスを置き換えるために表示されるボスも、体力の 50% の状態になります。これは、各フェーズが完全に異なる体力を持つことが可能であり、問題が発生しないことを意味します。

- フェーズボスは、デフォルトの戦闘外ボス再生システムによって完全に回復すると、フェーズ 1 に戻ります。

- 地域ボスでもあるフェーズボスは、すべてのフェーズで同じリーシュ半径とタイムアウトメカニズムを共有し、復活タイマーが終了した後、フェーズ 1 のボスとして復活します。


#### 警告

以下は、最初は直感に反する可能性のあるメカニズムのリストです。

- フェーズボスがどのフェーズでも倒されると、そのフェーズの戦利品をドロップします。つまり、誰かがフェーズボスを非常に早く倒した場合 (1 発で倒した場合)、実際に死亡して、そのボスファイルに構成されている戦利品をドロップします。これは、必ずしも最後のフェーズとは限りません。これは、このフェーズボスのすべてのボスファイルの戦利品テーブルを同じにするか、フェーズボスが数回のヒットで倒せないほど HP を多く持つようにすることで、修正できます。あるいは、フェーズをスキップできる人向けの特別な戦利品テーブルを用意することもできます。

- フェーズボスは実際には戦闘中にカスタムボスのスポーンを引き起こすため、スポーン時にはすべてのスポーンルーチンを実行します。そのため、スポーン時のメッセージやコマンドを使用する際には注意が必要です。また、フェーズボスは、フェーズが変更されても死亡せず、単に別のものに置き換えられます。つまり、死亡時に実行されるコマンドは、最後のフェーズボスに対してのみ実行されます。または、プレイヤーが十分なダメージを与えてフェーズをスキップした場合に実行されます。スポーン時に実行されるコマンドは、フェーズの変更にフックするために使用できます。\*注意: \* フェーズボスが完全に回復して再生された場合、フェーズ 1 のボスについては、スポーンメッセージは再度送信されません。

- フェーズボスは、フェーズ間でマウントされた状態になるか、マウントされていない状態になる可能性があります。マウントが死亡する前にフェーズボスが倒された場合、マウントは次のフェーズまで存続します。ボスが完全に回復した場合、マウントは削除され、ボスはマウントされなくなります。ただし、フェーズ 1 時にエンティティにマウントするように構成されている場合を除きます。

- フェーズ間で新しいカスタムボスがスポーンされるため、1 回限りのスポーンメカニズムはフェーズ間と完全な回復時にリセットされます。


### ヒントとテクニック

- 戦闘中、装備やエンティティの種類が変わることを利用して、戦闘中にボスがより危険に見えたり、危険に見えなくなったりすることができます。

- 可能ですが、特定の設計目標がない限り、フェーズボスが持つパワーは、フェーズ間で大きく変わらない方が良いでしょう。プレイヤーは、戦闘を通して自然な感覚を持つ進行を好む可能性が高いためです。

- onSpawn コマンドを使用して、フェーズ間でコマンドを実行できます。

- フェーズを使用して、ボスを近接モードと遠隔モードに切り替えることができます。

- フェーズボスは、大量の HP を持つ強力なボスとして構築されました。通常、ダンジョンの最終ボスエンカウンターまたは大きなワールドボスとして最適です。

- エンカウンターを設計する際には、フェーズ間でプレイヤーが援軍を倒さない可能性があることを考慮してください。

- ボスは任意の数のフェーズを持つことができますが、フェーズが多いほど、各フェーズが重要になるように、多くの HP が必要になります。

```

